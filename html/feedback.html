<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="../style.css">
    <link rel="shortcut icon" href="../images/Logoo.svg" type="image/x-icon">
    <title>DiveSea / Wallet</title>

    <script src="../js/wow.min.js"></script>
    <script>
        new WOW().init();
    </script>
</head>

<body>
    <div class="feedback-container">
        <section class="feedback-section">

            <div class="feedback-panel">
                <a href="../index.html">
                    <img src="../images/Nav-Logo.svg" alt="Logo" id="Logo">
                </a>

                <main>
                    <h3>–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏</h3>
                    <br>

                    <form id="feedback-form" class="form-block" novalidate>

                        <label>
                            <p>–í–∞—à–µ –∏–º—è *</p>
                            <input type="text" name="name" required minlength="2" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
                        </label>

                        <label>
                            <p>Email *</p>
                            <input type="email" name="email" required placeholder="example@mail.com">
                        </label>

                        <label>
                            <p>–¢–µ–ª–µ—Ñ–æ–Ω</p>
                            <input type="tel" name="phone" placeholder="+375 (__) ___‚Äë__‚Äë__">
                        </label>

                        <label>
                            <p>–°–æ–æ–±—â–µ–Ω–∏–µ *</p>
                            <textarea name="message" required minlength="5"
                                placeholder="–í–∞—à –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ —ç–∫—Å–∫—É—Ä—Å–∏—é"></textarea>
                        </label>

                        <button type="submit" class="form-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

                    </form>
                </main>
            </div>

            <div class="feedback-info">
                <h3>–ú—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏</h3>
                <br>
                <p>–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å, —É—Ç–æ—á–Ω–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ —ç–∫—Å–∫—É—Ä—Å–∏–∏ –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É ‚Äî –º—ã –æ—Ç–≤–µ—Ç–∏–º –≤–∞–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.</p>
            </div>

        </section>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const form = document.getElementById("feedback-form");
            const fields = form.querySelectorAll("input, textarea");

            // ============================
            // –ú–ê–°–ö–ê –¢–ï–õ–ï–§–û–ù–ê
            // ============================
            const phoneField = document.querySelector("input[name='phone']");

            phoneField.addEventListener("input", onPhoneInput);
            phoneField.addEventListener("focus", onPhoneFocus);
            phoneField.addEventListener("blur", onPhoneBlur);

            function onPhoneInput(e) {
                let value = e.target.value.replace(/\D/g, ""); // —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã

                // –ù–∞—á–∏–Ω–∞–µ–º –≤—Å–µ–≥–¥–∞ —Å 375
                if (!value.startsWith("375")) {
                    value = "375" + value;
                }

                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
                value = value.slice(0, 12);

                let formatted = "+375 ";

                if (value.length > 3) {
                    formatted += "(" + value.slice(3, 5);
                } else {
                    formatted += "(";
                }

                if (value.length >= 5) {
                    formatted += ") ";
                }

                if (value.length >= 5) {
                    formatted += value.slice(5, 8);
                }

                if (value.length >= 8) {
                    formatted += "-" + value.slice(8, 10);
                }

                if (value.length >= 10) {
                    formatted += "-" + value.slice(10, 12);
                }

                e.target.value = formatted;
            }

            function onPhoneFocus(e) {
                if (e.target.value === "") {
                    e.target.value = "+375 (";
                }
            }

            function onPhoneBlur(e) {
                if (e.target.value === "+375 (" || e.target.value === "+375 ()") {
                    e.target.value = "";
                }
            }

            // ============================
            // –°–û–ó–î–ê–ù–ò–ï –ö–û–ù–¢–ï–ô–ù–ï–†–û–í –û–®–ò–ë–û–ö
            // ============================
            fields.forEach(field => {
                const error = document.createElement("div");
                error.className = "input-error";
                error.style.color = "#d9534f";
                error.style.fontSize = "14px";
                error.style.marginTop = "4px";
                error.style.display = "none";
                field.parentNode.appendChild(error);

                field.addEventListener("input", () => {
                    error.style.display = "none";
                });
            });

            // ============================
            // –í–ê–õ–ò–î–ê–¶–ò–Ø
            // ============================
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const phonePattern = /^\+375\s?\((25|29|33|44)\)\s?\d{3}-\d{2}-\d{2}$/;

            form.addEventListener("submit", (e) => {
                e.preventDefault();

                let valid = true;

                const nameField = form.name;
                const emailField = form.email;
                const messageField = form.message;

                // –ò–º—è
                if (nameField.value.trim().length < 2) {
                    showError(nameField, "–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞.");
                    valid = false;
                }

                // Email
                if (!emailPattern.test(emailField.value.trim())) {
                    showError(emailField, "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email (–Ω–∞–ø—Ä–∏–º–µ—Ä: example@mail.com).");
                    valid = false;
                }

                // –¢–µ–ª–µ—Ñ–æ–Ω (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
                if (!phonePattern.test(phoneField.value.trim())) {
                    showError(phoneField, "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤ —Ñ–æ—Ä–º–∞—Ç–µ: +375 (29) 123-45-67");
                    valid = false;
                }

                // –°–æ–æ–±—â–µ–Ω–∏–µ
                if (messageField.value.trim().length < 5) {
                    showError(messageField, "–°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤.");
                    valid = false;
                }

                if (!valid) return;

                // ============================
                // –û–¢–ü–†–ê–í–ö–ê –í TELEGRAM
                // ============================
                const token = "8475014397:AAGob42RaxqJkhgPXu4vP3254ioHJd7565g";
                const chat_id = "7789506191";

                const text =
                    "üì© –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ —Å —Å–∞–π—Ç–∞\n\n" +
                    "üë§ –ò–º—è: " + nameField.value + "\n" +
                    "üìß Email: " + emailField.value + "\n" +
                    "üì± –¢–µ–ª–µ—Ñ–æ–Ω: " + phoneField.value + "\n" +
                    "üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ:\n" + messageField.value;

                fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        chat_id: chat_id,
                        text: text
                    })
                })
                    .then(() => {
                        alert("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –ú—ã —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.");
                        form.reset();
                    })
                    .catch(() => {
                        alert("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
                    });
            });

            function showError(field, message) {
                const error = field.parentNode.querySelector(".input-error");
                error.textContent = message;
                error.style.display = "block";
            }
        });
    </script>

</body>

</html>